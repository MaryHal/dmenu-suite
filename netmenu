#!/bin/sh
# Dmenu shutdown menu.
# This script assumes you can run "netctl" as a user through sudo without
# entering a password. This can be done by editing /etc/sudoers via visudo.

source $HOME/bin/menu/lib/dmenu_helpers.sh

netchoices="$(netctl list)"
other="
[Wifi-Menu]"

choice="$(echo "$netchoices $other" | awk '{print $1}' | $DMENU -l 10 -p "Option: ")"
[ -z "$choice" ] && exit

if [[ "$choice" == "[Wifi-Menu]" ]]; then
    $TERMINAL -e sh -c "sudo wifi-menu"
else
    # $choice = $(echo "$choice" | cut -c 3-)
    notify-send "Netctl" "Switching to profile \"$choice\""
    status=$(sudo netctl switch-to "$choice")

    if [[ $status == "0" ]]; then
        notify-send "Netctl" "Successfully connected to \"$choice\""
    else
        notify-send "Netctl" "Could not connect to \"$choice\""
    fi
fi

